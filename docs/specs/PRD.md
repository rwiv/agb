# PRD: agb (Agent Workflow Builder)

## 1. 프로젝트 개요
`agb`는 다양한 코딩 에이전트(Claude-code, Gemini-cli, OpenCode 등)를 위한 워크플로우 리소스(Commands, Agents, Skills)를 단일 소스에서 관리하고, 각 에이전트의 규격에 맞게 변환하여 빌드하는 CLI 도구입니다.

## 2. 배경 및 목적
현재 여러 코딩 에이전트들은 각기 다른 설정 방식과 파일 구조를 가지고 있습니다. 이로 인해 동일한 프롬프트나 스킬을 여러 에이전트에서 사용하려면 중복된 파일을 생성하고 관리해야 하는 번거로움이 발생합니다. `agb`는 이러한 중복을 제거하고, 한 곳에서 정의한 워크플로우를 여러 에이전트 환경으로 배포할 수 있도록 돕습니다.

## 3. 핵심 가치
- **중복 제로 (Zero Redundancy):** 단일 마크다운 소스로 여러 에이전트 지원.
- **명시적 관리:** 빌드 설정 파일을 통한 포함 리소스의 엄격한 제어.
- **이식성:** 플러그인 구조를 통한 워크플로우의 쉬운 공유 및 재사용.

## 4. 사용자 타겟
- 여러 종류의 AI 코딩 에이전트를 병행하여 사용하는 개발자.
- 복잡한 프롬프트 엔지니어링 결과물(Skills, Sub-agents)을 체계적으로 관리하고자 하는 사용자.

## 5. 주요 기능
### 5.1 플러그인 기반 리소스 관리
- `plugins/` 디렉터리 내에 독립적인 기능 단위로 리소스(Commands, Agents, Skills)를 구성합니다.
- 각 리소스는 내용(Markdown)과 메타데이터(JSON)로 분리되어 관리됩니다.

### 5.2 명시적 빌드 제어 (`agb.yaml`)
- 빌드 대상 디렉터리에 `agb.yaml` 설정 파일이 반드시 존재해야 합니다.
- 사용자는 `agb.yaml`에 포함할 플러그인의 특정 리소스를 명시적으로 선언합니다.
- 빌드 시 지정된 에이전트 규격(Target)에 맞춰 결과물을 생성합니다.

### 5.3 에이전트별 포맷 변환
- **Gemini-cli:** 마크다운 커스텀 커맨드를 TOML 규격으로 자동 변환합니다.
- **Claude-code / OpenCode:** 에이전트 규격에 최적화된 마크다운 구조로 빌드합니다.

### 5.4 리소스 병합 및 충돌 방지
- 여러 플러그인에서 선택된 리소스를 하나의 결과물로 병합합니다.
- 리소스 이름이 충돌할 경우 빌드를 실패 처리하여 안전성을 보장합니다.

### 5.5 전역 지침 관리
- 플러그인 외부의 `AGENTS.md`를 기반으로 에이전트의 전역 시스템 프롬프트를 설정합니다.

## 6. 제약 사항
- `agb.yaml` 파일이 없는 디렉터리에서의 빌드는 허용되지 않습니다.
- 플러그인 내부에는 `CLAUDE.md`, `GEMINI.md`와 같은 에이전트 전용 메인 메모리 파일이 존재할 수 없습니다.

## 7. 성공 지표
- 여러 에이전트 설정을 한 곳에서 관리하여 설정 파일의 중복 발생 건수를 0으로 유지함.
- 동일한 리소스를 서로 다른 에이전트 환경에서 성공적으로 로드하고 작동시킴.
